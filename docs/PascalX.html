

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>API documentation &mdash; PascalX 0.0.3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PascalX
          

          
            
            <img src="_static/Xlogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#genome">Genome</a></li>
<li class="toctree-l2"><a class="reference internal" href="#genescorer">Genescorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pathwayscorer">Pathwayscorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xscorer">Xscorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#genexprscorer">Genexprscorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#snp-database">SNP database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference-panel">Reference panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mapper">Mapper</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PascalX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/PascalX.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-documentation">
<h1>API documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<p>The PascalX package comes with the following user modules:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#genome">Genome</a> (<code class="code docutils literal notranslate"><span class="pre">PascalX.genome</span></code>)</p></li>
<li><p><a class="reference internal" href="#genescorer">Genescorer</a> (<code class="code docutils literal notranslate"><span class="pre">PascalX.genescorer</span></code>)</p></li>
<li><p><a class="reference internal" href="#pathwayscorer">Pathwayscorer</a> (<code class="code docutils literal notranslate"><span class="pre">PascalX.pathway</span></code>)</p></li>
<li><p><a class="reference internal" href="#xscorer">Xscorer</a> (<code class="code docutils literal notranslate"><span class="pre">PascalX.xscorer</span></code>)</p></li>
<li><p><a class="reference internal" href="#genexprscorer">Genexprscorer</a> (<code class="code docutils literal notranslate"><span class="pre">PascalX.genexpr</span></code>)</p></li>
</ul>
<p>Internal modules:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#snpdb">SNPdb</a> (<code class="code docutils literal notranslate"><span class="pre">PascalX.snpdb</span></code>)</p></li>
<li><p><a class="reference internal" href="#refpanel">RefPanel</a> (<code class="code docutils literal notranslate"><span class="pre">PascalX.refpanel</span></code>)</p></li>
<li><p><a class="reference internal" href="#mapper">Mapper</a> (<code class="code docutils literal notranslate"><span class="pre">PascalX.mapper</span></code>)</p></li>
</ul>
<hr class="docutils" />
<div class="section" id="genome">
<span id="id1"></span><h2>Genome<a class="headerlink" href="#genome" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PascalX.genome.genome">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.genome.</span></span><span class="sig-name descname"><span class="pre">genome</span></span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genome.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genome.genome" title="Permalink to this definition">¶</a></dt>
<dd><p>This class handles the genome annotation. It provides functionality for import of data from text files and automatic download of annotation data from ensembl.org.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genome.genome.gene_info">
<span class="sig-name descname"><span class="pre">gene_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genome.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genome.genome.gene_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the loaded information for given gene</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gene</strong> (<em>string</em>) – Symbol of gene to query</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genome.genome.get_ensembl_annotation">
<span class="sig-name descname"><span class="pre">get_ensembl_annotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genetype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein_coding'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GRCh38'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genome.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genome.genome.get_ensembl_annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Gene annotation download function for ensembl.org BioMart data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – File to store downloaded annotation in</p></li>
<li><p><strong>genetype</strong> (<em>string</em>) – Comma separated list of BioMart genetypes to download (protein_coding, pseudogene, …)</p></li>
<li><p><strong>version</strong> (<em>string</em>) – GRCh37 | CRCh38</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PascalX.genome</span> <span class="kn">import</span> <span class="n">genome</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">genome</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">get_ensemble_annotation</span><span class="p">(</span><span class="s1">&#39;ensemble_hg38.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genome.genome.load_genome">
<span class="sig-name descname"><span class="pre">load_genome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csymb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cstx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cetx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrStart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitchr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAgeneid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n/a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useNAgenes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genome.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genome.genome.load_genome" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports gene annotation from text file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>text</em>) – File to load</p></li>
<li><p><strong>ccol</strong> (<em>int</em>) – Column containing chromosome number</p></li>
<li><p><strong>cid</strong> (<em>int</em>) – Column containing gene id</p></li>
<li><p><strong>csymb</strong> (<em>int</em>) – Column containing gene symbol</p></li>
<li><p><strong>cstx</strong> (<em>int</em>) – Column containing transcription start</p></li>
<li><p><strong>cetx</strong> (<em>int</em>) – Column containing transcription end</p></li>
<li><p><strong>cs</strong> (<em>int</em>) – Column containing strand</p></li>
<li><p><strong>cb</strong> (<em>int</em>) – Column containing band (None if not supplied)</p></li>
<li><p><strong>chrStart</strong> (<em>int</em>) – Number of leading characters to skip in ccol</p></li>
<li><p><strong>splitchr</strong> (<em>string</em>) – Character used to separate columns in text file</p></li>
<li><p><strong>NAgeneid</strong> (<em>string</em>) – Identifier for not available gene id</p></li>
<li><p><strong>useNAgenes</strong> (<em>bool</em>) – Import genes without gene id</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – First line is header</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Internal:</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEID</span></code> (dict) - Contains the raw data with gene id (cid) as key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENESYMB</span></code> (dict) - Mapping from gene symbols (csymb) to gene ids (cid)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEIDtoSYMB</span></code> (dict) - Mapping from gene ids (cid) to gene symbols (csymb)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_CHR</span></code> (dict) - Mapping from chromosomes to list of gene symbols</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_BAND</span></code> (dict) - Mapping from band to list of gene symbols</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_SKIPPED</span></code> (dict) - Genes (cid) which could not be imported</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An unique gene id is automatically generated for n/a gene ids if <code class="docutils literal notranslate"><span class="pre">useNAgenes=true</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Identical gene ids occuring in more than one row are merged to a single gene, if on same chromosome and positional gap is &lt; 1Mb. The strand is taken from the longer segment.</p>
</div>
</dd></dl>

</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="genescorer">
<span id="id2"></span><h2>Genescorer<a class="headerlink" href="#genescorer" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.genescorer.</span></span><span class="sig-name descname"><span class="pre">chi2sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varcutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genome</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.load_refpanel">
<span class="sig-name descname"><span class="pre">load_refpanel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualityT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNPonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.load_refpanel" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the reference panel to use</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – /path/filename (without .chr#.db ending)</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – Number of cores to use for parallel import of reference panel</p></li>
<li><p><strong>keepfile</strong> – File with sample ids (one per line) to keep (only for .vcf)</p></li>
<li><p><strong>qualityT</strong> – Quality threshold for variant to keep (only for .vcf)</p></li>
<li><p><strong>SNPonly</strong> – Import only SNPs (only for .vcf)</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One file per chromosome with ending .chr#.db required (#: 1-22). If imported reference panel is not present, PascalX will automatically try to import from .chr#.tped.gz or .chr#.vcf.gz files.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.load_genome">
<span class="sig-name descname"><span class="pre">load_genome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csymb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cstx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cetx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrStart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitchr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAgeneid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n/a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useNAgenes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.load_genome" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports gene annotation from text file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>text</em>) – File to load</p></li>
<li><p><strong>ccol</strong> (<em>int</em>) – Column containing chromosome number</p></li>
<li><p><strong>cid</strong> (<em>int</em>) – Column containing gene id</p></li>
<li><p><strong>csymb</strong> (<em>int</em>) – Column containing gene symbol</p></li>
<li><p><strong>cstx</strong> (<em>int</em>) – Column containing transcription start</p></li>
<li><p><strong>cetx</strong> (<em>int</em>) – Column containing transcription end</p></li>
<li><p><strong>cs</strong> (<em>int</em>) – Column containing strand</p></li>
<li><p><strong>cb</strong> (<em>int</em>) – Column containing band (None if not supplied)</p></li>
<li><p><strong>chrStart</strong> (<em>int</em>) – Number of leading characters to skip in ccol</p></li>
<li><p><strong>splitchr</strong> (<em>string</em>) – Character used to separate columns in text file</p></li>
<li><p><strong>NAgeneid</strong> (<em>string</em>) – Identifier for not available gene id</p></li>
<li><p><strong>useNAgenes</strong> (<em>bool</em>) – Import genes without gene id</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – First line is header</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Internal:</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEID</span></code> (dict) - Contains the raw data with gene id (cid) as key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENESYMB</span></code> (dict) - Mapping from gene symbols (csymb) to gene ids (cid)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEIDtoSYMB</span></code> (dict) - Mapping from gene ids (cid) to gene symbols (csymb)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_CHR</span></code> (dict) - Mapping from chromosomes to list of gene symbols</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_BAND</span></code> (dict) - Mapping from band to list of gene symbols</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_SKIPPED</span></code> (dict) - Genes (cid) which could not be imported</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An unique gene id is automatically generated for n/a gene ids if <code class="docutils literal notranslate"><span class="pre">useNAgenes=true</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Identical gene ids occuring in more than one row are merged to a single gene, if on same chromosome and positional gap is &lt; 1Mb. The strand is taken from the longer segment.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.load_mapping">
<span class="sig-name descname"><span class="pre">load_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfilter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.load_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a SNP to gene mapping</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – File to load</p></li>
<li><p><strong>gcol</strong> (<em>int</em>) – Column with gene id</p></li>
<li><p><strong>rcol</strong> (<em>int</em>) – Column with SNP id</p></li>
<li><p><strong>ocol</strong> (<em>int</em>) – Column with weight</p></li>
<li><p><strong>splitchr</strong> (<em>string</em>) – Character used to separate columns</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – Header present</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>A loaded mapping takes precedence over a loaded positional gene annotation</p></li>
<li><p>The mapping data is stored statically (same for all class initializations)</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.load_GWAS">
<span class="sig-name descname"><span class="pre">load_GWAS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rscol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.load_GWAS" title="Permalink to this definition">¶</a></dt>
<dd><p>Load GWAS summary statistics p-values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – File containing the GWAS summary statistics data. Either as textfile or gzip compressed with ending .gz</p></li>
<li><p><strong>rscol</strong> (<em>int</em>) – Column of SNP ids</p></li>
<li><p><strong>pcol</strong> (<em>int</em>) – Column of p-values</p></li>
<li><p><strong>bcol</strong> (<em>int</em>) – Column of betas (optional)</p></li>
<li><p><strong>a1col</strong> (<em>int</em>) – Column of alternate allele (None for ignoring)</p></li>
<li><p><strong>a2col</strong> (<em>int</em>) – Column of reference allele (None for ignoring)</p></li>
<li><p><strong>delimiter</strong> (<em>String</em>) – Split character</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – Header present</p></li>
<li><p><strong>NAid</strong> (<em>String</em>) – Code for not available (rows are ignored)</p></li>
<li><p><strong>log10p</strong> (<em>bool</em>) – p-values are given -log10 transformed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.matchAlleles">
<span class="sig-name descname"><span class="pre">matchAlleles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SNPonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.matchAlleles" title="Permalink to this definition">¶</a></dt>
<dd><p>Matches alleles between loaded GWAS and reference panel
(SNPs with non matching alleles are removed)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>SNPonly</strong> (<em>bool</em>) – Keep only SNPs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.rank">
<span class="sig-name descname"><span class="pre">rank</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.rank" title="Permalink to this definition">¶</a></dt>
<dd><p>QQ normalizes the p-values of loaded GWAS</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.rank_mapper">
<span class="sig-name descname"><span class="pre">rank_mapper</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.rank_mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>QQ normalizes the p-values of loaded Mapper</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.save_GWAS">
<span class="sig-name descname"><span class="pre">save_GWAS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.save_GWAS" title="Permalink to this definition">¶</a></dt>
<dd><p>Save GWAS p-values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<em>string</em>) – Filename to store data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.save_scores">
<span class="sig-name descname"><span class="pre">save_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.save_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Save computed gene scores</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<em>string</em>) – Filename to store data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.load_scores">
<span class="sig-name descname"><span class="pre">load_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.load_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Load computed gene scores</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – Filename of data to load</p></li>
<li><p><strong>gcol</strong> (<em>int</em>) – Column with gene symbol</p></li>
<li><p><strong>pcol</strong> (<em>int</em>) – Column with p-value</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – File contains a header (True|False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unloadRef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intlimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autorescore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs gene scoring for a given list of gene symbols</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gene</strong> (<em>list</em>) – gene symbols to score.</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
<li><p><strong>unloadRef</strong> (<em>bool</em>) – Keep only reference data for one chromosome in memory (True, False) per core</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’,’pearson’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>intlimit</strong> (<em>int</em>) – Max # integration terms to use</p></li>
<li><p><strong>nobar</strong> (<em>bool</em>) – Show progress bar</p></li>
<li><p><strong>autorescore</strong> (<em>bool</em>) – Automatically try to re-score failed genes via Pearson’s algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.activateFails">
<span class="sig-name descname"><span class="pre">activateFails</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RESULT</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.activateFails" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method to force activate failed genes to success genes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Result</strong> (<em>list</em>) – Return of scoring function</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only use if you know what you are doing !</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.rescore">
<span class="sig-name descname"><span class="pre">rescore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RESULT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'davies'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'128b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intlimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.rescore" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Function to re-score only the failed gene scorings of a previous scoring run with different scorer settings.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RESULT</strong> (<em>list</em>) – Return of one of the gene scorring methods</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’,’pearson’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>intlimit</strong> (<em>int</em>) – Max # integration terms to use</p></li>
<li><p><strong>nobar</strong> – Show progress bar</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.score_chr">
<span class="sig-name descname"><span class="pre">score_chr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unloadRef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intlimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autorescore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.score_chr" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform gene scoring for full chromosomes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chrs</strong> (<em>list</em>) – List of chromosomes to score.</p></li>
<li><p><strong>unloadRef</strong> (<em>bool</em>) – Keep only reference data for one chromosome in memory (True, False) per core</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’,’pearson’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>intlimit</strong> (<em>int</em>) – Max # integration terms to use</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
<li><p><strong>nobar</strong> (<em>bool</em>) – Show progress bar</p></li>
<li><p><strong>autorescore</strong> (<em>bool</em>) – Automatically try to re-score failed genes via Pearson’s algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.score_all">
<span class="sig-name descname"><span class="pre">score_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intlimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autorescore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.score_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform full gene scoring</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’,’pearson’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>intlimit</strong> (<em>int</em>) – Max # integration terms to use</p></li>
<li><p><strong>nobar</strong> (<em>bool</em>) – Show progress bar</p></li>
<li><p><strong>autorescore</strong> (<em>bool</em>) – Automatically try to re-score failed genes via Pearson’s algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.score_gene_bulk_chr">
<span class="sig-name descname"><span class="pre">score_gene_bulk_chr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unloadRef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intlimit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autorescore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.score_gene_bulk_chr" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform scoring in bulk for supplied set of SNPs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chrs</strong> (<em>int</em>) – Chromosome number the supplied SNPs are located on</p></li>
<li><p><strong>gene</strong> (<em>string</em>) – Gene symbol for the SNPs</p></li>
<li><p><strong>data</strong><strong>(</strong><strong>list}</strong> – List of SNP data in format [ [rsid1,rsid2,…], [GWASid1, GWASid2,…], M ] with M a pvalue matrix (rows: GWAS, cols: rsid)</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’,’pearson’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>intlimit</strong> (<em>int</em>) – Max # integration terms to use</p></li>
<li><p><strong>autorescore</strong> (<em>bool</em>) – Automatically try to re-score failed genes via Pearson’s algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.get_topscores">
<span class="sig-name descname"><span class="pre">get_topscores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.get_topscores" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints and returns the top gene scores</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>N</strong> (<em>int</em>) – # to show</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ordered list of top scores</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.get_geneinfo">
<span class="sig-name descname"><span class="pre">get_geneinfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.get_geneinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows details of the loaded annotation for a gene</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gene</strong> (<em>String</em>) – Gene symbol</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.plot_Manhattan">
<span class="sig-name descname"><span class="pre">plot_Manhattan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ScoringResult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigLine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logsigThreshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelSig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelList</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'colorful'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.plot_Manhattan" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a Manhattan plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ScoringResult</strong> (<em>list</em>) – List of gene,p-value pairs [[‘Gene’,p-value],…] (if None, generate from internal _SCORES)</p></li>
<li><p><strong>region</strong> (<em>str</em>) – Band region to plot</p></li>
<li><p><strong>sigLine</strong> (<em>float</em>) – Draws a horizontal line at p-value (if &gt; 0)</p></li>
<li><p><strong>logsigThreshold</strong> (<em>float</em>) – Significance threshold above which to label genes (log(p) values)</p></li>
<li><p><strong>labelSig</strong> (<em>bool</em>) – Label genes above significance threshold</p></li>
<li><p><strong>labelList</strong> (<em>list</em>) – List of gene names to label</p></li>
<li><p><strong>style</strong> (<em>string</em>) – Design of the plot (‘classic’ | ‘colorful’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.plot_genesnps">
<span class="sig-name descname"><span class="pre">plot_genesnps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mark_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickspacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.plot_genesnps" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the SNP p-values for a list of genes and the genotypic SNP-SNP correlation matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> (<em>list</em>) – List of gene symbols</p></li>
<li><p><strong>show_correlation</strong> (<em>bool</em>) – Plot the corresponding SNP-SNP correlation matrix</p></li>
<li><p><strong>tickspacing</strong> (<em>int</em>) – Spacing of ticks for correlation plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genescorer.chi2sum.test_gene_assocdir">
<span class="sig-name descname"><span class="pre">test_gene_assocdir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genescorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genescorer.chi2sum.test_gene_assocdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests for directional association of the gene
(Requires betas of GWAS)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gene</strong> (<em>str</em>) – Gene symbol to test</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – Regularization parameter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="pathwayscorer">
<span id="id3"></span><h2>Pathwayscorer<a class="headerlink" href="#pathwayscorer" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PascalX.pathway.chi2rank">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.pathway.</span></span><span class="sig-name descname"><span class="pre">chi2rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genescorer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mergedist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fuse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Pathway scoring via chi2 of ranked gene p-values. Nearby genes can be merged to form meta-genes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>genescorer</strong> (<em>genescorer</em>) – The initialized genescorer to use to re-compute fused genes</p></li>
<li><p><strong>mergedist</strong> (<em>int</em>) – Maximum inbetween distance of genes to merge</p></li>
<li><p><strong>fuse</strong> (<em>bool</em>) – Fuse nearby genes to meta-genes</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PascalX.pathway.chi2rank.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2rank.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Scores a set of pathways/modules</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modules</strong> (<em>list</em>) – List of modules to score</p></li>
<li><p><strong>samples</strong> (<em>int</em>) – # of random gene sets to draw</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’,’pearson’,’saddle’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>nobar</strong> (<em>bool</em>) – Show progress bar</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.pathway.chi2rank.get_sigpathways">
<span class="sig-name descname"><span class="pre">get_sigpathways</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RESULT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2rank.get_sigpathways" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints significant pathways in the result set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RESULT</strong> (<em>list</em>) – Return of a pathwayscorer</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Significance threshold to print pathways</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.pathway.chi2rank.load_modules">
<span class="sig-name descname"><span class="pre">load_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2rank.load_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Load modules from tab separated file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – path/filename</p></li>
<li><p><strong>ncol</strong> (<em>int</em>) – Column with name of module</p></li>
<li><p><strong>fcol</strong> (<em>int</em>) – Column with first gene (symbol) in module. Remaining genes have to follow         separated</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.pathway.chi2rank.set_genescorer">
<span class="sig-name descname"><span class="pre">set_genescorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2rank.set_genescorer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the genescorer to use for re-computing p-values of fused genes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>S</strong> (<em>genescorer</em>) – The initialized genescorer to use</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PascalX.pathway.chi2perm">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.pathway.</span></span><span class="sig-name descname"><span class="pre">chi2perm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genescorer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mergedist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fuse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2perm" title="Permalink to this definition">¶</a></dt>
<dd><p>Pathway scoring via testing summed inverse chi2 transformed gene p-values against equally size random samples of gene sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>genescorer</strong> (<em>genescorer</em>) – The initialized genescorer to use to re-compute fused genes</p></li>
<li><p><strong>mergedist</strong> (<em>int</em>) – Maximum inbetween distance of genes to merge</p></li>
<li><p><strong>fuse</strong> (<em>bool</em>) – Fuse nearby genes to meta-genes</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Genes in the background gene sets are NOT fused.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="PascalX.pathway.chi2perm.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2perm.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Scores a set of pathways/modules</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modules</strong> (<em>list</em>) – List of modules to score</p></li>
<li><p><strong>samples</strong> (<em>int</em>) – # of random gene sets to draw</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’,’pearson’,’saddle’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>nobar</strong> (<em>bool</em>) – Show progress bar</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.pathway.chi2perm.get_sigpathways">
<span class="sig-name descname"><span class="pre">get_sigpathways</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RESULT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2perm.get_sigpathways" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints significant pathways in the result set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RESULT</strong> (<em>list</em>) – Return of a pathwayscorer</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Significance threshold to print pathways</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.pathway.chi2perm.load_modules">
<span class="sig-name descname"><span class="pre">load_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2perm.load_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Load modules from tab separated file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – path/filename</p></li>
<li><p><strong>ncol</strong> (<em>int</em>) – Column with name of module</p></li>
<li><p><strong>fcol</strong> (<em>int</em>) – Column with first gene (symbol) in module. Remaining genes have to follow         separated</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.pathway.chi2perm.set_genescorer">
<span class="sig-name descname"><span class="pre">set_genescorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/pathway.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.pathway.chi2perm.set_genescorer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the genescorer to use for re-computing p-values of fused genes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>S</strong> (<em>genescorer</em>) – The initialized genescorer to use</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="xscorer">
<span id="id4"></span><h2>Xscorer<a class="headerlink" href="#xscorer" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.xscorer.</span></span><span class="sig-name descname"><span class="pre">zsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varcutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leftTail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum" title="Permalink to this definition">¶</a></dt>
<dd><p>This class implements the cross scorer based on SNP coherence over gene windows.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.get_topscores">
<span class="sig-name descname"><span class="pre">get_topscores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.get_topscores" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints and returns the top gene scores</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>N</strong> (<em>int</em>) – # to show</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ordered list of top scores</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.jointlyRank">
<span class="sig-name descname"><span class="pre">jointlyRank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.jointlyRank" title="Permalink to this definition">¶</a></dt>
<dd><p>Jointly QQ normalizes the p-values of two GWAS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_A</strong> (<em>str</em>) – Identifier of first GWAS</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Identifier of second GWAS</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.jointlyRank_mapper">
<span class="sig-name descname"><span class="pre">jointlyRank_mapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.jointlyRank_mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Jointly QQ normalizes the p-values of GWAS and Mapper</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>E_A</strong> (<em>str</em>) – Identifier of first GWAS</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.load_GWAS">
<span class="sig-name descname"><span class="pre">load_GWAS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rscol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GWAS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n/a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mincutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNPonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.load_GWAS" title="Permalink to this definition">¶</a></dt>
<dd><p>Load GWAS summary statistics p-values and betas</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – File containing the GWAS summary statistics data. Either as textfile or gzip compressed with ending .gz</p></li>
<li><p><strong>rscol</strong> (<em>int</em>) – Column of SNP ids</p></li>
<li><p><strong>pcol</strong> (<em>int</em>) – Column of p-values</p></li>
<li><p><strong>bcol</strong> (<em>int</em>) – Column of betas</p></li>
<li><p><strong>a1col</strong> (<em>int</em>) – Column of alternate allele (None for ignoring alleles)</p></li>
<li><p><strong>a2col</strong> (<em>int</em>) – Column of reference allele (None for ignoring alleles)</p></li>
<li><p><strong>idcol</strong> – Column of identifiers, if several different GWAS in one file</p></li>
<li><p><strong>name</strong> – Identifier code for GWAS (needs to be unique)</p></li>
<li><p><strong>delimiter</strong> (<em>String</em>) – Split character</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – Header present</p></li>
<li><p><strong>NAid</strong> (<em>String</em>) – Code for not available (rows are ignored)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Only load data with p-value &lt; threshold</p></li>
<li><p><strong>SNPonly</strong> (<em>bool</em>) – Load only SNPs (only if a1col and a2col is specified)</p></li>
<li><p><strong>log10p</strong> (<em>bool</em>) – p-values are -log10 transformed</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The loaded GWAS data is shared between different xscorer instances !</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.load_genome">
<span class="sig-name descname"><span class="pre">load_genome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csymb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cstx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cetx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrStart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitchr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAgeneid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n/a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useNAgenes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.load_genome" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports gene annotation from text file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>text</em>) – File to load</p></li>
<li><p><strong>ccol</strong> (<em>int</em>) – Column containing chromosome number</p></li>
<li><p><strong>cid</strong> (<em>int</em>) – Column containing gene id</p></li>
<li><p><strong>csymb</strong> (<em>int</em>) – Column containing gene symbol</p></li>
<li><p><strong>cstx</strong> (<em>int</em>) – Column containing transcription start</p></li>
<li><p><strong>cetx</strong> (<em>int</em>) – Column containing transcription end</p></li>
<li><p><strong>cs</strong> (<em>int</em>) – Column containing strand</p></li>
<li><p><strong>chrStart</strong> (<em>int</em>) – Number of leading characters to skip in ccol</p></li>
<li><p><strong>splitchr</strong> (<em>string</em>) – Character used to separate columns in text file</p></li>
<li><p><strong>NAgeneid</strong> (<em>string</em>) – Identifier for not available gene id</p></li>
<li><p><strong>useNAgenes</strong> (<em>bool</em>) – Import genes without gene id</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – First line is header</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Internal:</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEID</span></code> (dict) - Contains the raw data with gene id (cid) as key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENESYMB</span></code> (dict) - Mapping from gene symbols (csymb) to gene ids (cid)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEIDtoSYMB</span></code> (dict) - Mapping from gene ids (cid) to gene symbols (csymb)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_CHR</span></code> (dict) - Mapping from chromosomes to list of gene symbols</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_BAND</span></code> (dict) - Mapping from band to list of gene symbols</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_SKIPPED</span></code> (dict) - Genes (cid) which could not be imported</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An unique gene id is automatically generated for n/a gene ids if <code class="docutils literal notranslate"><span class="pre">useNAgenes=true</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Identical gene ids occuring in more than one row are merged to a single gene, if on same chromosome and positional gap is &lt; 1Mb. The strand is taken from the longer segment.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.load_mapping">
<span class="sig-name descname"><span class="pre">load_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfilter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.load_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a SNP to gene mapping</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – File to load</p></li>
<li><p><strong>gcol</strong> (<em>int</em>) – Column with gene id</p></li>
<li><p><strong>rcol</strong> (<em>int</em>) – Column with SNP id</p></li>
<li><p><strong>wcol</strong> (<em>int</em>) – Column with weight</p></li>
<li><p><strong>bcol</strong> (<em>int</em>) – Column with additional weight</p></li>
<li><p><strong>splitchr</strong> (<em>string</em>) – Character used to separate columns</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – Header present</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.load_refpanel">
<span class="sig-name descname"><span class="pre">load_refpanel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualityT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNPonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.load_refpanel" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the reference panel to use</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – /path/filename (without .chr#.db ending)</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – Number of cores to use for parallel import of reference panel</p></li>
<li><p><strong>keepfile</strong> – File with sample ids (one per line) to keep (only for .vcf)</p></li>
<li><p><strong>qualityT</strong> – Quality threshold for variant to keep (only for .vcf)</p></li>
<li><p><strong>SNPonly</strong> – Import only SNPs (only for .vcf)</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One file per chromosome with ending .chr#.db required (#: 1-22). If imported reference panel is not present, PascalX will automatically try to import from .chr#.tped.gz or .chr#.vcf.gz files.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.matchAlleles">
<span class="sig-name descname"><span class="pre">matchAlleles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchRefPanel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.matchAlleles" title="Permalink to this definition">¶</a></dt>
<dd><p>Matches alleles between two GWAS
(SNPs with non matching alleles are removed)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_A</strong> (<em>str</em>) – Identifier of first GWAS</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Identifier of second GWAS</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.matchAlleles_mapper">
<span class="sig-name descname"><span class="pre">matchAlleles_mapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchRefPanel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.matchAlleles_mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Matches alleles between GWAS and Mapper loaded data
(SNPs with non matching alleles are removed)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_A</strong> (<em>str</em>) – Identifier of GWAS</p></li>
<li><p><strong>matchRefPanel</strong> (<em>bool</em>) – Match also with reference panel alleles</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.plot_genesnps">
<span class="sig-name descname"><span class="pre">plot_genesnps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zscore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mark_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickspacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'limegreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'darkviolet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrcmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.plot_genesnps" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the SNP p-values for a list of genes and the genotypic SNP-SNP correlation matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> (<em>list</em>) – List of gene symbols</p></li>
<li><p><strong>show_correlation</strong> (<em>bool</em>) – Plot the corresponding SNP-SNP correlation matrix</p></li>
<li><p><strong>mark_window</strong> (<em>bool</em>) – Mark the gene transcription start and end positions</p></li>
<li><p><strong>MAF</strong> (<em>float</em>) – MAF filter (None for value set in class)</p></li>
<li><p><strong>tickspacing</strong> (<em>int</em>) – Spacing of ticks</p></li>
<li><p><strong>pcolor</strong> (<em>color</em>) – Color for positive SNP associations</p></li>
<li><p><strong>ncolor</strong> (<em>color</em>) – Color for negative SNP associations</p></li>
<li><p><strong>corrcmap</strong> (<em>cmap</em>) – Colormap to use for correlation plot (None for default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autorescore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs cross scoring for a given list of gene symbols</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gene</strong> (<em>list</em>) – gene symbols to score.</p></li>
<li><p><strong>E_A</strong> (<em>str</em>) – First GWAS to use</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Second GWAS to use</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
<li><p><strong>unloadRef</strong> (<em>bool</em>) – Keep only reference data for one chromosome in memory (True, False) per core</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>intlimit</strong> (<em>int</em>) – Max # integration terms to use</p></li>
<li><p><strong>threshold</strong> (<em>bool</em>) – Threshold p-value to reqacc</p></li>
<li><p><strong>nobar</strong> (<em>bool</em>) – Show progress bar</p></li>
<li><p><strong>autorescore</strong> (<em>bool</em>) – Automatically try to re-score failed genes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.score_all">
<span class="sig-name descname"><span class="pre">score_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcorr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.score_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs cross scoring for all gene symbols</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_A</strong> (<em>str</em>) – First GWAS to use</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Second GWAS to use</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>nobar</strong> (<em>bool</em>) – Show progress bar</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.score_chr">
<span class="sig-name descname"><span class="pre">score_chr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['1',</span> <span class="pre">'2',</span> <span class="pre">'3',</span> <span class="pre">'4',</span> <span class="pre">'5',</span> <span class="pre">'6',</span> <span class="pre">'7',</span> <span class="pre">'8',</span> <span class="pre">'9',</span> <span class="pre">'10',</span> <span class="pre">'11',</span> <span class="pre">'12',</span> <span class="pre">'13',</span> <span class="pre">'14',</span> <span class="pre">'15',</span> <span class="pre">'16',</span> <span class="pre">'17',</span> <span class="pre">'18',</span> <span class="pre">'19',</span> <span class="pre">'20',</span> <span class="pre">'21',</span> <span class="pre">'22']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcorr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.score_chr" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs cross scoring for gene symbols on given chromosomes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chr</strong> (<em>list</em>) – Chromosomes to score.</p></li>
<li><p><strong>E_A</strong> (<em>str</em>) – First GWAS to use</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Second GWAS to use</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.zsum.score_map">
<span class="sig-name descname"><span class="pre">score_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.zsum.score_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs cross scoring for gene symbols given by mapper</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.xscorer.</span></span><span class="sig-name descname"><span class="pre">rsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varcutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leftTail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum" title="Permalink to this definition">¶</a></dt>
<dd><p>This class implements the ratio cross scorer based on SNP coherence/variance over gene windows.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.get_topscores">
<span class="sig-name descname"><span class="pre">get_topscores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.get_topscores" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints and returns the top gene scores</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>N</strong> (<em>int</em>) – # to show</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ordered list of top scores</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.jointlyRank">
<span class="sig-name descname"><span class="pre">jointlyRank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.jointlyRank" title="Permalink to this definition">¶</a></dt>
<dd><p>Jointly QQ normalizes the p-values of two GWAS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_A</strong> (<em>str</em>) – Identifier of first GWAS</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Identifier of second GWAS</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.jointlyRank_mapper">
<span class="sig-name descname"><span class="pre">jointlyRank_mapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.jointlyRank_mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Jointly QQ normalizes the p-values of GWAS and Mapper</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>E_A</strong> (<em>str</em>) – Identifier of first GWAS</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.load_GWAS">
<span class="sig-name descname"><span class="pre">load_GWAS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rscol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GWAS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n/a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mincutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNPonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.load_GWAS" title="Permalink to this definition">¶</a></dt>
<dd><p>Load GWAS summary statistics p-values and betas</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – File containing the GWAS summary statistics data. Either as textfile or gzip compressed with ending .gz</p></li>
<li><p><strong>rscol</strong> (<em>int</em>) – Column of SNP ids</p></li>
<li><p><strong>pcol</strong> (<em>int</em>) – Column of p-values</p></li>
<li><p><strong>bcol</strong> (<em>int</em>) – Column of betas</p></li>
<li><p><strong>a1col</strong> (<em>int</em>) – Column of alternate allele (None for ignoring alleles)</p></li>
<li><p><strong>a2col</strong> (<em>int</em>) – Column of reference allele (None for ignoring alleles)</p></li>
<li><p><strong>idcol</strong> – Column of identifiers, if several different GWAS in one file</p></li>
<li><p><strong>name</strong> – Identifier code for GWAS (needs to be unique)</p></li>
<li><p><strong>delimiter</strong> (<em>String</em>) – Split character</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – Header present</p></li>
<li><p><strong>NAid</strong> (<em>String</em>) – Code for not available (rows are ignored)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Only load data with p-value &lt; threshold</p></li>
<li><p><strong>SNPonly</strong> (<em>bool</em>) – Load only SNPs (only if a1col and a2col is specified)</p></li>
<li><p><strong>log10p</strong> (<em>bool</em>) – p-values are -log10 transformed</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The loaded GWAS data is shared between different xscorer instances !</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.load_genome">
<span class="sig-name descname"><span class="pre">load_genome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csymb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cstx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cetx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrStart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitchr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAgeneid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n/a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useNAgenes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.load_genome" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports gene annotation from text file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>text</em>) – File to load</p></li>
<li><p><strong>ccol</strong> (<em>int</em>) – Column containing chromosome number</p></li>
<li><p><strong>cid</strong> (<em>int</em>) – Column containing gene id</p></li>
<li><p><strong>csymb</strong> (<em>int</em>) – Column containing gene symbol</p></li>
<li><p><strong>cstx</strong> (<em>int</em>) – Column containing transcription start</p></li>
<li><p><strong>cetx</strong> (<em>int</em>) – Column containing transcription end</p></li>
<li><p><strong>cs</strong> (<em>int</em>) – Column containing strand</p></li>
<li><p><strong>chrStart</strong> (<em>int</em>) – Number of leading characters to skip in ccol</p></li>
<li><p><strong>splitchr</strong> (<em>string</em>) – Character used to separate columns in text file</p></li>
<li><p><strong>NAgeneid</strong> (<em>string</em>) – Identifier for not available gene id</p></li>
<li><p><strong>useNAgenes</strong> (<em>bool</em>) – Import genes without gene id</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – First line is header</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Internal:</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEID</span></code> (dict) - Contains the raw data with gene id (cid) as key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENESYMB</span></code> (dict) - Mapping from gene symbols (csymb) to gene ids (cid)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEIDtoSYMB</span></code> (dict) - Mapping from gene ids (cid) to gene symbols (csymb)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_CHR</span></code> (dict) - Mapping from chromosomes to list of gene symbols</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_BAND</span></code> (dict) - Mapping from band to list of gene symbols</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_SKIPPED</span></code> (dict) - Genes (cid) which could not be imported</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An unique gene id is automatically generated for n/a gene ids if <code class="docutils literal notranslate"><span class="pre">useNAgenes=true</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Identical gene ids occuring in more than one row are merged to a single gene, if on same chromosome and positional gap is &lt; 1Mb. The strand is taken from the longer segment.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.load_mapping">
<span class="sig-name descname"><span class="pre">load_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfilter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.load_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a SNP to gene mapping</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>string</em>) – File to load</p></li>
<li><p><strong>gcol</strong> (<em>int</em>) – Column with gene id</p></li>
<li><p><strong>rcol</strong> (<em>int</em>) – Column with SNP id</p></li>
<li><p><strong>wcol</strong> (<em>int</em>) – Column with weight</p></li>
<li><p><strong>bcol</strong> (<em>int</em>) – Column with additional weight</p></li>
<li><p><strong>splitchr</strong> (<em>string</em>) – Character used to separate columns</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – Header present</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.load_refpanel">
<span class="sig-name descname"><span class="pre">load_refpanel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualityT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNPonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.load_refpanel" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the reference panel to use</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – /path/filename (without .chr#.db ending)</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – Number of cores to use for parallel import of reference panel</p></li>
<li><p><strong>keepfile</strong> – File with sample ids (one per line) to keep (only for .vcf)</p></li>
<li><p><strong>qualityT</strong> – Quality threshold for variant to keep (only for .vcf)</p></li>
<li><p><strong>SNPonly</strong> – Import only SNPs (only for .vcf)</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One file per chromosome with ending .chr#.db required (#: 1-22). If imported reference panel is not present, PascalX will automatically try to import from .chr#.tped.gz or .chr#.vcf.gz files.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.matchAlleles">
<span class="sig-name descname"><span class="pre">matchAlleles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchRefPanel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.matchAlleles" title="Permalink to this definition">¶</a></dt>
<dd><p>Matches alleles between two GWAS
(SNPs with non matching alleles are removed)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_A</strong> (<em>str</em>) – Identifier of first GWAS</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Identifier of second GWAS</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.matchAlleles_mapper">
<span class="sig-name descname"><span class="pre">matchAlleles_mapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchRefPanel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.matchAlleles_mapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Matches alleles between GWAS and Mapper loaded data
(SNPs with non matching alleles are removed)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_A</strong> (<em>str</em>) – Identifier of GWAS</p></li>
<li><p><strong>matchRefPanel</strong> (<em>bool</em>) – Match also with reference panel alleles</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.plot_genesnps">
<span class="sig-name descname"><span class="pre">plot_genesnps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zscore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mark_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tickspacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'limegreen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'darkviolet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrcmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.plot_genesnps" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the SNP p-values for a list of genes and the genotypic SNP-SNP correlation matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> (<em>list</em>) – List of gene symbols</p></li>
<li><p><strong>show_correlation</strong> (<em>bool</em>) – Plot the corresponding SNP-SNP correlation matrix</p></li>
<li><p><strong>mark_window</strong> (<em>bool</em>) – Mark the gene transcription start and end positions</p></li>
<li><p><strong>MAF</strong> (<em>float</em>) – MAF filter (None for value set in class)</p></li>
<li><p><strong>tickspacing</strong> (<em>int</em>) – Spacing of ticks</p></li>
<li><p><strong>pcolor</strong> (<em>color</em>) – Color for positive SNP associations</p></li>
<li><p><strong>ncolor</strong> (<em>color</em>) – Color for negative SNP associations</p></li>
<li><p><strong>corrcmap</strong> (<em>cmap</em>) – Colormap to use for correlation plot (None for default)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autorescore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs cross scoring for a given list of gene symbols</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gene</strong> (<em>list</em>) – gene symbols to score.</p></li>
<li><p><strong>E_A</strong> (<em>str</em>) – First GWAS to use</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Second GWAS to use</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
<li><p><strong>unloadRef</strong> (<em>bool</em>) – Keep only reference data for one chromosome in memory (True, False) per core</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>intlimit</strong> (<em>int</em>) – Max # integration terms to use</p></li>
<li><p><strong>threshold</strong> (<em>bool</em>) – Threshold p-value to reqacc</p></li>
<li><p><strong>nobar</strong> (<em>bool</em>) – Show progress bar</p></li>
<li><p><strong>autorescore</strong> (<em>bool</em>) – Automatically try to re-score failed genes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.score_all">
<span class="sig-name descname"><span class="pre">score_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcorr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nobar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reqacc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.score_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs cross scoring for all gene symbols</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_A</strong> (<em>str</em>) – First GWAS to use</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Second GWAS to use</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method to use to evaluate tail probability (‘auto’,’davies’,’ruben’,’satterthwaite’)</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Precision mode to use (‘’,’128b’,’100d’)</p></li>
<li><p><strong>reqacc</strong> (<em>float</em>) – requested accuracy</p></li>
<li><p><strong>nobar</strong> (<em>bool</em>) – Show progress bar</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.score_chr">
<span class="sig-name descname"><span class="pre">score_chr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['1',</span> <span class="pre">'2',</span> <span class="pre">'3',</span> <span class="pre">'4',</span> <span class="pre">'5',</span> <span class="pre">'6',</span> <span class="pre">'7',</span> <span class="pre">'8',</span> <span class="pre">'9',</span> <span class="pre">'10',</span> <span class="pre">'11',</span> <span class="pre">'12',</span> <span class="pre">'13',</span> <span class="pre">'14',</span> <span class="pre">'15',</span> <span class="pre">'16',</span> <span class="pre">'17',</span> <span class="pre">'18',</span> <span class="pre">'19',</span> <span class="pre">'20',</span> <span class="pre">'21',</span> <span class="pre">'22']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcorr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.score_chr" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs cross scoring for gene symbols on given chromosomes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chr</strong> (<em>list</em>) – Chromosomes to score.</p></li>
<li><p><strong>E_A</strong> (<em>str</em>) – First GWAS to use</p></li>
<li><p><strong>E_B</strong> (<em>str</em>) – Second GWAS to use</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.xscorer.rsum.score_map">
<span class="sig-name descname"><span class="pre">score_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/xscorer.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.xscorer.rsum.score_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs cross scoring for gene symbols given by mapper</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parallel</strong> (<em>int</em>) – # of cores to use</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="genexprscorer">
<span id="id5"></span><h2>Genexprscorer<a class="headerlink" href="#genexprscorer" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PascalX.genexpr.genexpr">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.genexpr.</span></span><span class="sig-name descname"><span class="pre">genexpr</span></span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genexpr.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genexpr.genexpr" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="PascalX.genexpr.genexpr.get_GTEX_expr">
<span class="sig-name descname"><span class="pre">get_GTEX_expr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genexpr.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genexpr.genexpr.get_GTEX_expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads GTEx v8 data and imports.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – Filename to store downloaded GTEX data</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The import may take several hours.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genexpr.genexpr.load_expr">
<span class="sig-name descname"><span class="pre">load_expr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genexpr.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genexpr.genexpr.load_expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the GTEx data for usage</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – File to load</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genexpr.genexpr.load_genome">
<span class="sig-name descname"><span class="pre">load_genome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csymb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cstx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cetx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrStart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splitchr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAgeneid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n/a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useNAgenes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genexpr.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genexpr.genexpr.load_genome" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports gene annotation from text file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>text</em>) – File to load</p></li>
<li><p><strong>ccol</strong> (<em>int</em>) – Column containing chromosome number</p></li>
<li><p><strong>cid</strong> (<em>int</em>) – Column containing gene id</p></li>
<li><p><strong>csymb</strong> (<em>int</em>) – Column containing gene symbol</p></li>
<li><p><strong>cstx</strong> (<em>int</em>) – Column containing transcription start</p></li>
<li><p><strong>cetx</strong> (<em>int</em>) – Column containing transcription end</p></li>
<li><p><strong>cs</strong> (<em>int</em>) – Column containing strand</p></li>
<li><p><strong>chrStart</strong> (<em>int</em>) – Number of leading characters to skip in ccol</p></li>
<li><p><strong>splitchr</strong> (<em>string</em>) – Character used to separate columns in text file</p></li>
<li><p><strong>NAgeneid</strong> (<em>string</em>) – Identifier for not available gene id</p></li>
<li><p><strong>useNAgenes</strong> (<em>bool</em>) – Import genes without gene id</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – First line is header</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt><strong>Internal:</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEID</span></code> (dict) - Contains the raw data with gene id (cid) as key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENESYMB</span></code> (dict) - Mapping from gene symbols (csymb) to gene ids (cid)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GENEIDtoSYMB</span></code> (dict) - Mapping from gene ids (cid) to gene symbols (csymb)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_CHR</span></code> (dict) - Mapping from chromosomes to list of gene symbols</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_SKIPPED</span></code> (dict) - Genes (cid) which could not be imported</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An unique gene id is automatically generated for n/a gene ids if <code class="docutils literal notranslate"><span class="pre">useNAgenes=true</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Identical gene ids occuring in more than one row are merged to a single gene, if on same chromosome and positional gap is &lt; 1Mb. The strand is taken from the longer segment.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genexpr.genexpr.chi2rank">
<span class="sig-name descname"><span class="pre">chi2rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathways</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fuse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genexpr.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genexpr.genexpr.chi2rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates tissue enrichment scores for set of genes using GTEx data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pathways</strong> (<em>list</em>) – List of pathways to score [ [‘name’,[‘gene1’,’gene2’,…]],…]</p></li>
<li><p><strong>fuse</strong> (<em>bool</em>) – Fuse nearby genes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.genexpr.genexpr.plot_genexpr">
<span class="sig-name descname"><span class="pre">plot_genexpr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tzscore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.01,</span> <span class="pre">0.5)</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/genexpr.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.genexpr.genexpr.plot_genexpr" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots gene expression matrix for list of genes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>genes</strong> (<em>list</em>) – list of genes</p></li>
<li><p><strong>tzscore</strong> (<em>bool</em>) – zscore over tissues per gene (true|false)</p></li>
<li><p><strong>cbar_pos</strong> (<em>list</em>) – Position coordinates of color bar</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="snp-database">
<span id="snpdb"></span><h2>SNP database<a class="headerlink" href="#snp-database" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PascalX.snpdb.db">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.snpdb.</span></span><span class="sig-name descname"><span class="pre">db</span></span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for handling storage of the raw genotype data. The data is indexed and stored for each chromosome individually as zlib compressed pickle. The indexing allows fast random access via SNP ids or positions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.open">
<span class="sig-name descname"><span class="pre">open</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens storage file. A new file is created if not exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – Name to use for the storage file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores set of rows into the file storage</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – First storage key is the key in the dictionary. Second storage key is the first element of the inner list.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If all insert calls are done, the close function has to be called once to make the index persistent.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all stored data for a set of SNPs indexed via positions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pos</strong> (<em>list</em>) – Positions of SNPs to retrieve</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.getSNPatPos">
<span class="sig-name descname"><span class="pre">getSNPatPos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.getSNPatPos" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns SNP id at position</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pos</strong> (<em>list</em>) – Positions of SNPs to retrieve</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.getPosatSNPs">
<span class="sig-name descname"><span class="pre">getPosatSNPs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snpids</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.getPosatSNPs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the position corresponding to a snpid
WARNING: Inefficient</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.getSNPs">
<span class="sig-name descname"><span class="pre">getSNPs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snps</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.getSNPs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all stored data for a set of SNPs indexed via SNP ids</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>snp</strong> (<em>list</em>) – ids of SNPs to retrieve</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.getSNPKeys">
<span class="sig-name descname"><span class="pre">getSNPKeys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.getSNPKeys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the SNP ids in storage</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.getKeys">
<span class="sig-name descname"><span class="pre">getKeys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.getKeys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns SNP positions in storage</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.getSortedKeys">
<span class="sig-name descname"><span class="pre">getSortedKeys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.getSortedKeys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sorted list of SNP positions in storage</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.snpdb.db.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/snpdb.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.snpdb.db.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes open storage file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>After all inserts are done this function has to be called once to re-generate the index and close the storage file.</p>
</div>
</dd></dl>

</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="reference-panel">
<span id="refpanel"></span><h2>Reference panel<a class="headerlink" href="#reference-panel" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PascalX.refpanel.refpanel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.refpanel.</span></span><span class="sig-name descname"><span class="pre">refpanel</span></span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/refpanel.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.refpanel.refpanel" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="PascalX.refpanel.refpanel.load_pos_reference">
<span class="sig-name descname"><span class="pre">load_pos_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cr</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/refpanel.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.refpanel.refpanel.load_pos_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a snpdb object for a chromosome and a sorted list of SNP positions on the chromosome</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cr</strong> (<em>int</em>) – Chromosome number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.refpanel.refpanel.load_snp_reference">
<span class="sig-name descname"><span class="pre">load_snp_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cr</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/refpanel.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.refpanel.refpanel.load_snp_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a snpdb object for a chromosome</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cr</strong> (<em>int</em>) – Chromosome number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.refpanel.refpanel.set_refpanel">
<span class="sig-name descname"><span class="pre">set_refpanel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualityT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNPonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chrlist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourcefilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regEx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/refpanel.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.refpanel.refpanel.set_refpanel" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the reference panel to use</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – /path/filename (without .chr#.db ending)</p></li>
<li><p><strong>parallel</strong> (<em>int</em>) – Number of cores to use for parallel import of reference panel</p></li>
<li><p><strong>keepfile</strong> (<em>string</em>) – [only for .vcf] File with sample ids (one per line) to keep.  None to keep all.</p></li>
<li><p><strong>qualityT</strong> (<em>int</em>) – [only for .vcf] Quality threshold for variant to keep (None to ignore)</p></li>
<li><p><strong>SNPonly</strong> (<em>bool</em>) – [only for .vcf] Load only SNPs</p></li>
<li><p><strong>chrlist</strong> (<em>list</em>) – List of chromosomes to import. (None to import 1-22)</p></li>
<li><p><strong>sourcefilename</strong> (<em>string</em>) – /path/filename (without .chr#. ending) of .tped | .vcf files. None to use same as filename</p></li>
<li><p><strong>regEx</strong> (<em>string</em>) – Regular expression to filter sample ids. First capture group is kept. [only for .vcf]</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One file per chromosome with ending .chr#.db required (#: 1-22). If imported reference panel is not present, PascalX will automatically try to import from .chr#.tped.gz or .chr#.vcf.gz files.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Alleles (under .vcf import) are stored internally in the order [ALT,REF].</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.refpanel.refpanel.getSNPtoChrMap">
<span class="sig-name descname"><span class="pre">getSNPtoChrMap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/refpanel.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.refpanel.refpanel.getSNPtoChrMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary mapping SNP id to corresponding chromosome number</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PascalX.refpanel.refpanel.getChrSNPs">
<span class="sig-name descname"><span class="pre">getChrSNPs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cr</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/refpanel.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.refpanel.refpanel.getChrSNPs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns SNP ids for a chromosome</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cr</strong> (<em>int</em>) – Chromosome number</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<hr class="docutils" />
</div>
<div class="section" id="mapper">
<span id="id6"></span><h2>Mapper<a class="headerlink" href="#mapper" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="PascalX.mapper.mapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">PascalX.mapper.</span></span><span class="sig-name descname"><span class="pre">mapper</span></span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/mapper.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.mapper.mapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="PascalX.mapper.mapper.load_mapping">
<span class="sig-name descname"><span class="pre">load_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a1col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a2col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfilter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/BergmannLab/PascalX/tree/main/python/PascalX/mapper.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PascalX.mapper.mapper.load_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a SNP to gene mapping
:param file: File to load
:type file: string
:param gcol: Column with gene id
:type gcol: int
:param rcol: Column with SNP id
:type rcol: int
:param wcol: Column with weight
:type wcol: int
:param bcol: Column with additional weight
:type bcol: int
:param delimiter: Character used to separate columns
:type delimiter: string
:param header: Header present
:type header: bool
:param clear:
:type clear: bool
:param pfilter: Only include rows with wcol &lt; pfilter
:type pfilter: float</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="usage.html" class="btn btn-neutral float-left" title="Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021-2022, Bergmann lab and contributors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>